At first the code was well structured.
It's not anymore. I am sorry for making you thread thru this.
